import{d as D,i as H,c as n,a as c,e,b as v,t as o,M as J,u as g,L as f,T as K,o as i,f as O,S as Q,r as h,w as X,j as N,v as k,l as Y}from"./index-Dub0P0Pe.js";import{_ as S}from"./Spinner.vue_vue_type_script_setup_true_lang-DRfAUG5y.js";import{u as Z,S as ee}from"./useDriverProfile-BDSEDL2B.js";const se={class:"space-y-6"},te={class:"grid gap-6 lg:grid-cols-3"},oe={class:"rounded-xl border bg-white shadow-sm relative overflow-hidden"},ae={class:"p-6 border-b text-center space-y-2"},le={class:"text-lg font-semibold"},ne={class:"text-sm text-gray-500"},re={class:"text-xs text-gray-500"},de={class:"font-medium"},ie={key:0,class:"text-sm text-red-600"},ue={class:"p-6 space-y-3 text-sm text-gray-600"},ce={class:"flex justify-between"},me={class:"font-medium text-gray-900"},ve={class:"flex justify-between"},pe={class:"font-medium text-gray-900"},we={class:"flex justify-between"},ge={class:"font-medium text-gray-900"},_e={class:"flex justify-between"},fe={class:"font-medium text-gray-900"},xe={class:"flex justify-between"},ye={class:"font-medium text-gray-900"},be={key:0,class:"absolute inset-0 bg-white/70 grid place-items-center"},he={class:"rounded-xl border bg-white shadow-sm"},Ne={class:"p-6 border-b flex items-center gap-2"},ke={class:"p-6 space-y-4 text-sm text-gray-600"},Ae={class:"grid grid-cols-2 gap-4"},Pe={class:"font-medium text-gray-900"},$e={class:"font-medium text-gray-900"},Ce={class:"font-medium text-gray-900"},De={class:"font-medium text-gray-900"},Se={class:"grid grid-cols-2 gap-4"},Ve={class:"font-medium text-gray-900"},Me={class:"font-medium text-gray-900"},je={class:"font-medium text-gray-900"},Te={class:"font-medium text-gray-900"},Be={key:0,class:"rounded-lg bg-gray-50 border border-dashed border-gray-200 p-3 text-xs text-gray-500"},Ie={key:1,class:"text-xs text-amber-600 bg-amber-50 border border-amber-200 rounded-lg px-3 py-2"},Ue={class:"rounded-xl border bg-white shadow-sm"},Fe={class:"p-6 border-b flex items-center gap-2"},Le={class:"p-6 space-y-4 text-sm text-gray-600"},qe={class:"font-medium text-gray-900"},ze={class:"font-medium text-gray-900"},Ee={class:"border-t pt-3"},Re={class:"space-y-2 text-xs text-gray-500"},Ge={key:0},We=D({__name:"DriverProfile",setup(V){const{profile:r,vehicle:t,loading:m,error:d,load:u}=Z();H(()=>{u()});const x=n(()=>{const a=r.value?.user;return[a?.first_name,a?.last_name].filter(Boolean).join(" ").trim()||a?.email||a?.username||"Driver"}),y=n(()=>r.value?.id?String(r.value.id):"N/A"),_=n(()=>r.value?.user?.email||"N/A"),l=n(()=>r.value?.phone||"N/A"),p=n(()=>r.value?.license_number||"N/A"),A=n(()=>r.value?.status||(r.value?.active?"Active":"Inactive")),M=n(()=>w(r.value?.start_date||r.value?.created_at)),j=n(()=>{const a=w(r.value?.start_date),s=r.value?.end_date?w(r.value?.end_date):"Present";return a==="N/A"&&s==="Present"?"N/A":`${a} -> ${s}`}),T=n(()=>w(r.value?.created_at)),B=n(()=>w(r.value?.updated_at)),I=n(()=>!!t.value),U=n(()=>t.value?.type||"N/A"),F=n(()=>{if(!t.value)return"N/A";const{make:a,model:s}=t.value;return[a,s].filter(Boolean).join(" ")||"N/A"}),L=n(()=>t.value?.color||"N/A"),q=n(()=>t.value?.license_plate||"N/A"),z=n(()=>$(t.value?.capacity,"packages")),E=n(()=>$(t.value?.maximum_load_kg??t.value?.maximum_total_weight_kg,"kg")),R=n(()=>t.value?.engine_type?W(t.value.engine_type):"N/A"),G=n(()=>w(t.value?.next_inspection_date)),P=n(()=>t.value?.notes||null);function w(a){if(!a)return"N/A";const s=new Date(a);return Number.isNaN(s.getTime())?"N/A":new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"short",year:"numeric"}).format(s)}function $(a,s){if(a==null)return"N/A";const b=Number(a);if(!Number.isFinite(b))return"N/A";const C=new Intl.NumberFormat("en-US",{maximumFractionDigits:1}).format(b);return s?`${C} ${s}`:C}function W(a){return a&&a.charAt(0).toUpperCase()+a.slice(1)}return(a,s)=>(i(),c("section",se,[e("div",te,[e("article",oe,[e("header",ae,[s[1]||(s[1]=e("div",{class:"mx-auto h-24 w-24 rounded-full overflow-hidden ring-2 ring-green-200"},[e("img",{class:"h-full w-full object-cover",src:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",alt:"Driver avatar"})],-1)),e("h3",le,o(x.value),1),e("p",ne,"Driver ID: "+o(y.value),1),e("p",re,[s[0]||(s[0]=J("Status: ",-1)),e("span",de,o(A.value),1)]),g(d)?(i(),c("p",ie,o(g(d)),1)):v("",!0)]),e("dl",ue,[e("div",ce,[s[2]||(s[2]=e("dt",null,"Member since",-1)),e("dd",me,o(M.value),1)]),e("div",ve,[s[3]||(s[3]=e("dt",null,"Email",-1)),e("dd",pe,o(_.value),1)]),e("div",we,[s[4]||(s[4]=e("dt",null,"Phone",-1)),e("dd",ge,o(l.value),1)]),e("div",_e,[s[5]||(s[5]=e("dt",null,"License number",-1)),e("dd",fe,o(p.value),1)]),e("div",xe,[s[6]||(s[6]=e("dt",null,"Work period",-1)),e("dd",ye,o(j.value),1)])]),g(m)?(i(),c("div",be,[f(S)])):v("",!0)]),e("article",he,[e("header",Ne,[f(g(K),{class:"w-4 h-4 text-green-600","aria-hidden":"true"}),s[7]||(s[7]=e("h3",{class:"text-lg font-semibold"},"Vehicle Details",-1))]),e("div",ke,[e("div",Ae,[e("div",null,[s[8]||(s[8]=e("div",{class:"text-gray-500"},"Type",-1)),e("div",Pe,o(U.value),1)]),e("div",null,[s[9]||(s[9]=e("div",{class:"text-gray-500"},"Make / Model",-1)),e("div",$e,o(F.value),1)]),e("div",null,[s[10]||(s[10]=e("div",{class:"text-gray-500"},"Color",-1)),e("div",Ce,o(L.value),1)]),e("div",null,[s[11]||(s[11]=e("div",{class:"text-gray-500"},"License Plate",-1)),e("div",De,o(q.value),1)])]),e("div",Se,[e("div",null,[s[12]||(s[12]=e("div",{class:"text-gray-500"},"Capacity",-1)),e("div",Ve,o(z.value),1)]),e("div",null,[s[13]||(s[13]=e("div",{class:"text-gray-500"},"Max load",-1)),e("div",Me,o(E.value),1)]),e("div",null,[s[14]||(s[14]=e("div",{class:"text-gray-500"},"Engine",-1)),e("div",je,o(R.value),1)]),e("div",null,[s[15]||(s[15]=e("div",{class:"text-gray-500"},"Next inspection",-1)),e("div",Te,o(G.value),1)])]),P.value?(i(),c("div",Be,o(P.value),1)):v("",!0),I.value?v("",!0):(i(),c("p",Ie," Vehicle information is unavailable. Contact your administrator to register a vehicle profile. "))])]),e("article",Ue,[e("header",Fe,[f(g(ee),{class:"w-4 h-4 text-yellow-500","aria-hidden":"true"}),s[16]||(s[16]=e("h3",{class:"text-lg font-semibold"},"Account Summary",-1))]),e("div",Le,[e("div",null,[s[17]||(s[17]=e("span",{class:"text-gray-500"},"Created",-1)),e("div",qe,o(T.value),1)]),e("div",null,[s[18]||(s[18]=e("span",{class:"text-gray-500"},"Last updated",-1)),e("div",ze,o(B.value),1)]),e("div",Ee,[s[21]||(s[21]=e("div",{class:"text-gray-500 mb-2"},"Recent notes",-1)),e("ul",Re,[s[19]||(s[19]=e("li",null,"98% on-time deliveries in the past 30 days.",-1)),s[20]||(s[20]=e("li",null,"Assigned to downtown & suburbs service zone.",-1)),A.value==="Inactive"?(i(),c("li",Ge,"Reactivation requires administrator approval.")):v("",!0)])])])])])]))}}),He={class:"space-y-6"},Je={class:"rounded-xl border bg-white p-6 shadow-sm"},Ke={class:"grid gap-4 md:grid-cols-2"},Oe={class:"flex items-center gap-3 flex-wrap"},Qe=["disabled"],Xe=["disabled"],Ye={key:0,class:"text-sm text-red-600"},Ze={key:1,class:"text-sm text-green-600"},os=D({__name:"ProfileView",setup(V){const{changePassword:r}=O(),t=Q({old_password:"",new_password1:"",new_password2:""}),m=h(!1),d=h(null),u=h(null);function x(){t.old_password="",t.new_password1="",t.new_password2="",d.value=null,u.value=null}async function y(){if(t.new_password1!==t.new_password2){d.value="New passwords do not match.",u.value=null;return}if(t.new_password1.length<8){d.value="Password must be at least 8 characters long.",u.value=null;return}m.value=!0,d.value=null,u.value=null;try{await r({old_password:t.old_password,new_password1:t.new_password1,new_password2:t.new_password2}),u.value="Password updated successfully.",t.old_password="",t.new_password1="",t.new_password2=""}catch(_){d.value=_?.message||"Failed to update password."}finally{m.value=!1}}return(_,l)=>(i(),c("section",He,[l[8]||(l[8]=e("h2",{class:"text-2xl font-semibold"},"Profile",-1)),f(We),e("div",Je,[l[6]||(l[6]=e("h3",{class:"text-lg font-semibold"},"Change Password",-1)),l[7]||(l[7]=e("p",{class:"text-sm text-gray-600 mb-4"}," Update your password to secure your account. Passwords must match and be at least 8 characters long. ",-1)),e("form",{class:"space-y-4",onSubmit:X(y,["prevent"])},[e("div",null,[l[3]||(l[3]=e("label",{class:"block text-sm font-medium mb-1",for:"old-password"},"Current Password",-1)),N(e("input",{id:"old-password","onUpdate:modelValue":l[0]||(l[0]=p=>t.old_password=p),type:"password",required:"",autocomplete:"current-password",class:"w-full h-10 px-3 rounded-lg border"},null,512),[[k,t.old_password]])]),e("div",Ke,[e("div",null,[l[4]||(l[4]=e("label",{class:"block text-sm font-medium mb-1",for:"new-password"},"New Password",-1)),N(e("input",{id:"new-password","onUpdate:modelValue":l[1]||(l[1]=p=>t.new_password1=p),type:"password",required:"",minlength:"8",autocomplete:"new-password",class:"w-full h-10 px-3 rounded-lg border"},null,512),[[k,t.new_password1]])]),e("div",null,[l[5]||(l[5]=e("label",{class:"block text-sm font-medium mb-1",for:"confirm-password"},"Confirm New Password",-1)),N(e("input",{id:"confirm-password","onUpdate:modelValue":l[2]||(l[2]=p=>t.new_password2=p),type:"password",required:"",minlength:"8",autocomplete:"new-password",class:"w-full h-10 px-3 rounded-lg border"},null,512),[[k,t.new_password2]])])]),e("div",Oe,[e("button",{type:"submit",disabled:m.value,class:"h-10 px-4 rounded-lg bg-green-600 text-white hover:bg-green-700 disabled:opacity-50 flex items-center gap-2"},[m.value?(i(),Y(S,{key:0,size:"sm"})):v("",!0),e("span",null,o(m.value?"Updating...":"Save Password"),1)],8,Qe),e("button",{type:"button",class:"text-sm text-gray-600 hover:underline",onClick:x,disabled:m.value}," Clear ",8,Xe)]),d.value?(i(),c("div",Ye,o(d.value),1)):v("",!0),u.value?(i(),c("div",Ze,o(u.value),1)):v("",!0)],32)])]))}});export{os as default};
